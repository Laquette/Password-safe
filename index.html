<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Password Safe</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
body { background: #000; color: #fff; height: 100vh; overflow: hidden; }
.header { background: #17a097; padding: 20px; text-align: center; }
.container { padding: 20px; max-width: 600px; margin: 0 auto; height: calc(100vh - 200px); overflow-y: auto; }
.screen { display: none; }
.screen.active { display: block; }
input { width: 100%; padding: 15px; background: #1a1a1a; border: 1px solid #333; color: #fff; border-radius: 8px; margin-bottom: 15px; }
.btn { width: 100%; padding: 15px; background: #ff6b35; color: #fff; border: none; border-radius: 25px; cursor: pointer; margin-bottom: 15px; }
.nav-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #17a097; display: flex; justify-content: space-around; padding: 10px 0; }
.nav-item { flex: 1; text-align: center; padding: 10px; cursor: pointer; color: #fff; }
.nav-item.active { background: rgba(255,255,255,0.2); }
.category-card { padding: 20px; border-radius: 12px; text-align: center; cursor: pointer; margin-bottom: 15px; }
.entry-item { background: #1a1a1a; padding: 15px; border-radius: 12px; margin-bottom: 15px; cursor: pointer; }
.toast { position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%); background: #333; color: #fff; padding: 15px 25px; border-radius: 25px; opacity: 0; transition: all 0.3s; }
.toast.show { opacity: 1; }
</style>
</head>
<body>

<div class="header">
    <h1>Password Safe</h1>
</div>

<div id="loginScreen" class="screen active">
    <div class="container">
        <h2>Bienvenue</h2>
        <p style="margin: 20px 0; color: #888;">Cr√©ez votre mot de passe principal</p>
        <input type="password" id="pass1" placeholder="Mot de passe (min. 6 caract√®res)">
        <input type="password" id="pass2" placeholder="Confirmer">
        <button class="btn" onclick="createPassword()">Cr√©er mon coffre-fort</button>
    </div>
</div>

<div id="mainScreen" class="screen">
    <div class="container">
        <input type="text" placeholder="Recherche" onkeyup="search(this.value)">
        <div id="categories"></div>
        <button class="btn" onclick="addEntry()">+ Ajouter une entr√©e</button>
    </div>
</div>

<div id="settingsScreen" class="screen">
    <div class="container">
        <h2>Param√®tres</h2>
        <button class="btn" onclick="exportData()">Exporter</button>
        <button class="btn" onclick="importData()">Importer</button>
        <button class="btn" onclick="resetApp()">R√©initialiser</button>
    </div>
</div>

<div class="nav-bar">
    <div class="nav-item active" onclick="showScreen('mainScreen', this)">
        <div>üìä</div>
        <small>Donn√©es</small>
    </div>
    <div class="nav-item" onclick="alert('Fonction OTP disponible dans la version PRO')">
        <div>üîë</div>
        <small>OTP</small>
    </div>
    <div class="nav-item" onclick="showScreen('settingsScreen', this)">
        <div>‚öôÔ∏è</div>
        <small>Param√®tres</small>
    </div>
</div>

<div id="toast" class="toast"></div>

<script>
let db = { entries: [], password: '' };

function createPassword() {
    const p1 = document.getElementById('pass1').value;
    const p2 = document.getElementById('pass2').value;
    if (p1.length < 6) { showToast('Minimum 6 caract√®res'); return; }
    if (p1 !== p2) { showToast('Les mots de passe ne correspondent pas'); return; }
    db.password = p1;
    localStorage.setItem('pws_db', JSON.stringify(db));
    showScreen('mainScreen');
    showToast('Coffre-fort cr√©√© !');
}

function showScreen(screenId, navItem) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
    if (navItem) {
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        navItem.classList.add('active');
    }
    if (screenId === 'mainScreen') loadCategories();
}

function loadCategories() {
    const cats = document.getElementById('categories');
    cats.innerHTML = '<div class="category-card" style="background:#607d8b">Toutes les entr√©es (' + db.entries.length + ')</div>';
    db.entries.forEach(e => {
        cats.innerHTML += '<div class="entry-item">' + e.title + '</div>';
    });
}

function addEntry() {
    const title = prompt('Nom de l\'entr√©e:');
    if (title) {
        const username = prompt('Nom d\'utilisateur:');
        const password = prompt('Mot de passe:');
        db.entries.push({ title, username, password });
        localStorage.setItem('pws_db', JSON.stringify(db));
        loadCategories();
        showToast('Entr√©e ajout√©e');
    }
}

function search(query) {
    const filtered = db.entries.filter(e => e.title.toLowerCase().includes(query.toLowerCase()));
    const cats = document.getElementById('categories');
    cats.innerHTML = '<div class="category-card" style="background:#607d8b">R√©sultats (' + filtered.length + ')</div>';
    filtered.forEach(e => {
        cats.innerHTML += '<div class="entry-item">' + e.title + '</div>';
    });
}

function exportData() {
    const data = JSON.stringify(db);
    const blob = new Blob([data], {type: 'text/plain'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'backup.json';
    a.click();
    showToast('Donn√©es export√©es');
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = event => {
            try {
                db = JSON.parse(event.target.result);
                localStorage.setItem('pws_db', JSON.stringify(db));
                showToast('Donn√©es import√©es');
            } catch {
                showToast('Erreur d\'importation');
            }
        };
        reader.readAsText(file);
    };
    input.click();
}

function resetApp() {
    if (confirm('Supprimer toutes les donn√©es?')) {
        localStorage.clear();
        db = { entries: [], password: '' };
        location.reload();
    }
}

function showToast(msg) {
    const toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
}

// Init
const saved = localStorage.getItem('pws_db');
if (saved) {
    db = JSON.parse(saved);
    if (db.password) {
        const pass = prompt('Entrez votre mot de passe:');
        if (pass === db.password) {
            showScreen('mainScreen');
        } else {
            alert('Mot de passe incorrect');
            location.reload();
        }
    }
}
</script>

</body>
</html>
